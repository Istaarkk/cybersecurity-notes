<!DOCTYPE html>
<html lang="fr-fr">
<head><script src="/cybersecurity-notes/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=cybersecurity-notes/livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FCSC 2024 - Challenge de Reverse Engineering | WriteUps &amp; Recherches Cybersécurité</title>
    <meta name="description" content="Write-up: Challenge de Reverse Engineering Introduction Ce write-up présente la résolution d&rsquo;un challenge de reverse engineering où nous devions analyser du code assembleur pour trouver un flag au format FCSC{&hellip;}.
Analyse du code Le code fourni est une représentation désassemblée d&rsquo;un programme binaire. En analysant les fonctions principales, nous avons pu comprendre le fonctionnement général du programme:
main() initialise le programme et déchiffre trois chaînes de caractères en effectuant un XOR avec des constantes (0x42, 0x13, 0x37) Le programme obtient une entrée utilisateur via VsvYbpipYYgRoCeFtoxhtAmdFuNu3WvV() Cette entrée est transformée par wKtyPoT4WdyrkVzhvYUfvqo3M9iPVMd3() Le résultat est comparé avec une valeur cible (jMunhwoW4bRqeCdJfXvfNrRm) dans VakkEeHbtHMpNqXPMkadR4v7K() Le mécanisme de chiffrement La fonction clé est wKtyPoT4WdyrkVzhvYUfvqo3M9iPVMd3() qui transforme l&rsquo;entrée utilisateur comme suit:">
    
    
    <meta property="og:title" content="FCSC 2024 - Challenge de Reverse Engineering">
    <meta property="og:description" content="Write-up: Challenge de Reverse Engineering Introduction Ce write-up présente la résolution d&rsquo;un challenge de reverse engineering où nous devions analyser du code assembleur pour trouver un flag au format FCSC{&hellip;}.
Analyse du code Le code fourni est une représentation désassemblée d&rsquo;un programme binaire. En analysant les fonctions principales, nous avons pu comprendre le fonctionnement général du programme:
main() initialise le programme et déchiffre trois chaînes de caractères en effectuant un XOR avec des constantes (0x42, 0x13, 0x37) Le programme obtient une entrée utilisateur via VsvYbpipYYgRoCeFtoxhtAmdFuNu3WvV() Cette entrée est transformée par wKtyPoT4WdyrkVzhvYUfvqo3M9iPVMd3() Le résultat est comparé avec une valeur cible (jMunhwoW4bRqeCdJfXvfNrRm) dans VakkEeHbtHMpNqXPMkadR4v7K() Le mécanisme de chiffrement La fonction clé est wKtyPoT4WdyrkVzhvYUfvqo3M9iPVMd3() qui transforme l&rsquo;entrée utilisateur comme suit:">
    <meta property="og:type" content="article">
    <meta property="og:url" content="http://localhost:1313/cybersecurity-notes/writeups/fcsc/2024-04-27-reverse-challenge/">
    
    
    <link rel="icon" type="image/svg+xml" href="/cybersecurity-notes/images/favicon.svg">
    <link rel="icon" type="image/png" href="/cybersecurity-notes/images/favicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-dark.min.css">
    
    
    <link rel="stylesheet" href="/cybersecurity-notes/css/main.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/custom.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/dropdown.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/enhanced.css">
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/lib/highlight.min.js"></script>
    
    
    <script src="/cybersecurity-notes/js/copy-code.js" defer></script>
    <script src="/cybersecurity-notes/js/enhanced.js" defer></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="http://localhost:1313/cybersecurity-notes/" class="nav-brand">
                <i class="fas fa-shield-alt"></i> WriteUps &amp; Recherches Cybersécurité
            </a>
            <div class="nav-links">
                
                
                <a href="http://localhost:1313/cybersecurity-notes/writeups/" class="nav-link">
                    
                        <i class="fas fa-flag"></i>
                    
                    WriteUps
                </a>
                
                
                
                <a href="http://localhost:1313/cybersecurity-notes/veille/" class="nav-link">
                    
                        <i class="fas fa-rss"></i>
                    
                    Veille
                </a>
                
                
                
                <a href="http://localhost:1313/cybersecurity-notes/outils/" class="nav-link">
                    
                        <i class="fas fa-tools"></i>
                    
                    Outils
                </a>
                
                
            </div>
        </div>
    </nav>
</body>
</html> 
<main class="content">
    
<article class="single-page">
    <header class="page-header">
        <div class="breadcrumbs">
            <a href="http://localhost:1313/cybersecurity-notes/">Accueil</a> &gt;
            
            
            <a href="/categories/reverse">reverse</a> &gt;
            
            
            <span>FCSC 2024 - Challenge de Reverse Engineering</span>
        </div>
        
        <h1>FCSC 2024 - Challenge de Reverse Engineering</h1>
        
        <div class="meta">
            <div class="meta-item">
                <i class="far fa-calendar-alt"></i>
                <span>27/04/2024</span>
            </div>
            
            
            <div class="meta-item">
                <i class="fas fa-tags"></i>
                <div class="tags">
                    
                    <a href="/tags/reverse-engineering" class="tag">reverse-engineering</a>
                    
                    <a href="/tags/assembly" class="tag">assembly</a>
                    
                    <a href="/tags/cryptography" class="tag">cryptography</a>
                    
                </div>
            </div>
            
            
            
            <div class="meta-item">
                <i class="fas fa-flag"></i>
                <div class="tags">
                    
                    <a href="/ctfs/fcsc" class="tag">fcsc</a>
                    
                </div>
            </div>
            
            
            <div class="meta-item reading-time">
                <i class="far fa-clock"></i>
                <span>3 min</span>
            </div>
        </div>
    </header>
    
    
    <div class="toc-container">
        <div class="toc-header">
            <i class="fas fa-list"></i> Table des matières
        </div>
        <div class="toc-content">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#analyse-du-code">Analyse du code</a></li>
    <li><a href="#le-mécanisme-de-chiffrement">Le mécanisme de chiffrement</a></li>
    <li><a href="#données-importantes">Données importantes</a></li>
    <li><a href="#solution-reverse-engineering-de-lalgorithme">Solution: Reverse engineering de l&rsquo;algorithme</a></li>
    <li><a href="#résultat">Résultat</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
        </div>
    </div>
    
    
    <div class="content">
        <h1 id="write-up-challenge-de-reverse-engineering">Write-up: Challenge de Reverse Engineering</h1>
<h2 id="introduction">Introduction</h2>
<p>Ce write-up présente la résolution d&rsquo;un challenge de reverse engineering où nous devions analyser du code assembleur pour trouver un flag au format FCSC{&hellip;}.</p>
<h2 id="analyse-du-code">Analyse du code</h2>
<p>Le code fourni est une représentation désassemblée d&rsquo;un programme binaire. En analysant les fonctions principales, nous avons pu comprendre le fonctionnement général du programme:</p>
<ol>
<li><code>main()</code> initialise le programme et déchiffre trois chaînes de caractères en effectuant un XOR avec des constantes (0x42, 0x13, 0x37)</li>
<li>Le programme obtient une entrée utilisateur via <code>VsvYbpipYYgRoCeFtoxhtAmdFuNu3WvV()</code></li>
<li>Cette entrée est transformée par <code>wKtyPoT4WdyrkVzhvYUfvqo3M9iPVMd3()</code></li>
<li>Le résultat est comparé avec une valeur cible (<code>jMunhwoW4bRqeCdJfXvfNrRm</code>) dans <code>VakkEeHbtHMpNqXPMkadR4v7K()</code></li>
</ol>
<h2 id="le-mécanisme-de-chiffrement">Le mécanisme de chiffrement</h2>
<p>La fonction clé est <code>wKtyPoT4WdyrkVzhvYUfvqo3M9iPVMd3()</code> qui transforme l&rsquo;entrée utilisateur comme suit:</p>
<pre tabindex="0"><code>char rax_3 = *(sx.q(i) + &amp;aixxj3qmUvFTqgqLodmuaEap)
*(sx.q(i) + &amp;U94y77bvL3HfcnwcAc3UA9MJTvcwjP4j) = (i.b * 3 + 0x1f) ^ (rax_3 &lt;&lt; 3 | rax_3 s&gt;&gt; 5)
</code></pre><p>Pour chaque caractère de l&rsquo;entrée:</p>
<ol>
<li>Une clé est calculée comme <code>(index * 3 + 0x1f)</code></li>
<li>Le caractère est décalé (<code>(rax_3 &lt;&lt; 3 | rax_3 s&gt;&gt; 5)</code>)</li>
<li>La clé et le caractère décalé sont combinés par XOR</li>
</ol>
<h2 id="données-importantes">Données importantes</h2>
<p>Grâce aux données supplémentaires fournies, nous avons pu extraire:</p>
<ul>
<li>La valeur cible <code>jMunhwoW4bRqeCdJfXvfNrRm</code> à l&rsquo;adresse <code>0x4020</code></li>
<li>Les messages chiffrés pour l&rsquo;invite, le succès et l&rsquo;échec</li>
</ul>
<p>La valeur de <code>jMunhwoW4bRqeCdJfXvfNrRm</code> en hexadécimal:</p>
<pre tabindex="0"><code>2d 38 bf 32 f0 05 a8 b5 04 9b 8c 53 ca e7 f0 67 f6 59 c4 f1 50 e7 7a a5 
74 ab dc d9 50 f7 5a bd b6 2b 9e 31 90 37 08 1d 3e a9 2c 69 0a 67 38 9f 
0e 2b 24 93 72 1f 40 6d d4 7b ee 51 1a 4f ca 6d ec f1 24 cb 72 05 f1
</code></pre><h2 id="solution-reverse-engineering-de-lalgorithme">Solution: Reverse engineering de l&rsquo;algorithme</h2>
<p>Pour résoudre ce challenge, nous avons créé un script qui inverse l&rsquo;algorithme de chiffrement:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt_char</span>(encrypted_byte, index):
</span></span><span style="display:flex;"><span>    key <span style="color:#f92672">=</span> (index <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x1f</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Essayer tous les caractères possibles</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">127</span>):  <span style="color:#75715e"># Plage ASCII imprimable</span>
</span></span><span style="display:flex;"><span>        shifted <span style="color:#f92672">=</span> ((c <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">|</span> (c <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (key <span style="color:#f92672">^</span> shifted) <span style="color:#f92672">==</span> encrypted_byte:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> chr(c)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;?&#39;</span>  <span style="color:#75715e"># Si aucun caractère valide n&#39;est trouvé</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># La valeur hexadécimale de jMunhwoW4bRqeCdJfXvfNrRm</span>
</span></span><span style="display:flex;"><span>encrypted_bytes <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xb5</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0x67</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0xa5</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0xbd</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x1d</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x9f</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x6d</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0x6d</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0xf1</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, byte <span style="color:#f92672">in</span> enumerate(encrypted_bytes):
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">+=</span> decrypt_char(byte, i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Flag déchiffré:&#34;</span>, flag)
</span></span></code></pre></div><p>Pour chaque octet chiffré, nous cherchons le caractère original qui, une fois transformé par l&rsquo;algorithme, produirait l&rsquo;octet chiffré.</p>
<h2 id="résultat">Résultat</h2>
<p>L&rsquo;exécution du script nous a permis d&rsquo;obtenir le flag:</p>
<pre tabindex="0"><code>FCSC{e30f46b147e7a25a7c8b865d0d895c7c7315f69582f432e9405b6d093b6fb8d3}
</code></pre><h2 id="conclusion">Conclusion</h2>
<p>Ce challenge était un exemple typique de reverse engineering où il fallait:</p>
<ol>
<li>Comprendre le flux du programme</li>
<li>Identifier l&rsquo;algorithme de chiffrement/transformation</li>
<li>Extraire les données importantes (la valeur cible)</li>
<li>Inverser l&rsquo;algorithme pour récupérer le flag</li>
</ol>
<p>La difficulté principale résidait dans la compréhension précise de l&rsquo;algorithme de transformation et dans l&rsquo;extraction correcte des données hexadécimales à partir du code désassemblé.</p>

    </div>
    
    <div class="page-footer">
        
        
        <div class="related-posts">
            <h3><i class="fas fa-link"></i> Articles connexes</h3>
            <div class="related-grid">
                
                <a href="/cybersecurity-notes/writeups/reverse/gdb-nasm/" class="related-item">
                    <h4>GDB and NASM Assembly Guide - WriteUp</h4>
                    <div class="related-meta">
                        <span class="related-date">14/04/2024</span>
                        
                        <span class="related-tags">
                            
                            <span class="tag">assembly</span>
                            
                        </span>
                        
                    </div>
                </a>
                
            </div>
        </div>
        
        
        <div class="share">
            <span>Partager :</span>
            <a href="https://twitter.com/intent/tweet?url=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2ffcsc%2f2024-04-27-reverse-challenge%2f&text=FCSC%202024%20-%20Challenge%20de%20Reverse%20Engineering" target="_blank" aria-label="Twitter">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2ffcsc%2f2024-04-27-reverse-challenge%2f" target="_blank" aria-label="LinkedIn">
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="mailto:?subject=FCSC%202024%20-%20Challenge%20de%20Reverse%20Engineering&body=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2ffcsc%2f2024-04-27-reverse-challenge%2f" aria-label="Email">
                <i class="fas fa-envelope"></i>
            </a>
        </div>
    </div>
</article>

</main>
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-left">
                <p>&copy; 2025 WriteUps &amp; Recherches Cybersécurité</p>
            </div>
            <div class="footer-right">
                <div class="social-links">
                    <a href="https://github.com/Istaarkk" target="_blank" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="#" target="_blank" aria-label="Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" target="_blank" aria-label="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Site propulsé par <a href="https://gohugo.io/" target="_blank">Hugo</a> | Thème <span class="theme-name">CyberNotes</span></p>
        </div>
    </footer>

    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        hljs.highlightAll();
        
        
        document.querySelectorAll('pre code').forEach((block) => {
            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copier';
            
            const pre = block.parentNode;
            pre.style.position = 'relative';
            pre.insertBefore(button, pre.firstChild);
            
            button.addEventListener('click', () => {
                navigator.clipboard.writeText(block.textContent);
                button.textContent = 'Copié !';
                setTimeout(() => {
                    button.textContent = 'Copier';
                }, 2000);
            });
        });
        
        
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    });
    </script>
    
    
</body>
</html>  