<!DOCTYPE html>
<html lang="fr-fr">
<head><script src="/cybersecurity-notes/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=cybersecurity-notes/livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Apocalypse 2024 - SealedRune | WriteUps &amp; Recherches Cybersécurité</title>
    <meta name="description" content="SealedRune - Cyber Apocalypse 2024 Description du challenge SealedRune est un challenge de reverse engineering du Cyber Apocalypse CTF 2024. Le programme attend un input spécifique qui, une fois entré correctement, révèle le flag.
Analyse du binaire En analysant le binaire avec un désassembleur, nous avons découvert que le programme contient une chaîne encodée en Base64. Cette chaîne est ensuite décodée et comparée à l&rsquo;entrée utilisateur, mais avec une particularité : la comparaison se fait avec la chaîne inversée.">
    
    
    <meta property="og:title" content="Cyber Apocalypse 2024 - SealedRune">
    <meta property="og:description" content="SealedRune - Cyber Apocalypse 2024 Description du challenge SealedRune est un challenge de reverse engineering du Cyber Apocalypse CTF 2024. Le programme attend un input spécifique qui, une fois entré correctement, révèle le flag.
Analyse du binaire En analysant le binaire avec un désassembleur, nous avons découvert que le programme contient une chaîne encodée en Base64. Cette chaîne est ensuite décodée et comparée à l&rsquo;entrée utilisateur, mais avec une particularité : la comparaison se fait avec la chaîne inversée.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="http://localhost:1313/cybersecurity-notes/writeups/cyber-apocalypse/2024-04-14-sealedrune/">
    
    
    <link rel="icon" type="image/svg+xml" href="/cybersecurity-notes/images/favicon.svg">
    <link rel="icon" type="image/png" href="/cybersecurity-notes/images/favicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-dark.min.css">
    
    
    <link rel="stylesheet" href="/cybersecurity-notes/css/main.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/custom.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/dropdown.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/enhanced.css">
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/lib/highlight.min.js"></script>
    
    
    <script src="/cybersecurity-notes/js/copy-code.js" defer></script>
    <script src="/cybersecurity-notes/js/enhanced.js" defer></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="http://localhost:1313/cybersecurity-notes/" class="nav-brand">
                <i class="fas fa-shield-alt"></i> WriteUps &amp; Recherches Cybersécurité
            </a>
            <div class="nav-links">
                
                
                <a href="http://localhost:1313/cybersecurity-notes/writeups/" class="nav-link">
                    
                        <i class="fas fa-flag"></i>
                    
                    WriteUps
                </a>
                
                
                
                <a href="http://localhost:1313/cybersecurity-notes/veille/" class="nav-link">
                    
                        <i class="fas fa-rss"></i>
                    
                    Veille
                </a>
                
                
                
                <a href="http://localhost:1313/cybersecurity-notes/outils/" class="nav-link">
                    
                        <i class="fas fa-tools"></i>
                    
                    Outils
                </a>
                
                
            </div>
        </div>
    </nav>
</body>
</html> 
<main class="content">
    
<article class="single-page">
    <header class="page-header">
        <div class="breadcrumbs">
            <a href="http://localhost:1313/cybersecurity-notes/">Accueil</a> &gt;
            
            
            <a href="/categories/reverse">reverse</a> &gt;
            
            
            <span>Cyber Apocalypse 2024 - SealedRune</span>
        </div>
        
        <h1>Cyber Apocalypse 2024 - SealedRune</h1>
        
        <div class="meta">
            <div class="meta-item">
                <i class="far fa-calendar-alt"></i>
                <span>14/04/2024</span>
            </div>
            
            
            <div class="meta-item">
                <i class="fas fa-tags"></i>
                <div class="tags">
                    
                    <a href="/tags/binary-analysis" class="tag">binary-analysis</a>
                    
                    <a href="/tags/decompilation" class="tag">decompilation</a>
                    
                </div>
            </div>
            
            
            
            <div class="meta-item">
                <i class="fas fa-flag"></i>
                <div class="tags">
                    
                    <a href="/ctfs/cyber-apocalypse" class="tag">cyber-apocalypse</a>
                    
                </div>
            </div>
            
            
            <div class="meta-item reading-time">
                <i class="far fa-clock"></i>
                <span>3 min</span>
            </div>
        </div>
    </header>
    
    
    <div class="toc-container">
        <div class="toc-header">
            <i class="fas fa-list"></i> Table des matières
        </div>
        <div class="toc-content">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#description-du-challenge">Description du challenge</a></li>
    <li><a href="#analyse-du-binaire">Analyse du binaire</a></li>
    <li><a href="#exploitation">Exploitation</a></li>
    <li><a href="#résolution">Résolution</a></li>
    <li><a href="#étapes-de-lexploitation-manuelle">Étapes de l&rsquo;exploitation manuelle</a></li>
    <li><a href="#flag">Flag</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
        </div>
    </div>
    
    
    <div class="content">
        <h1 id="sealedrune---cyber-apocalypse-2024">SealedRune - Cyber Apocalypse 2024</h1>
<h2 id="description-du-challenge">Description du challenge</h2>
<p>SealedRune est un challenge de reverse engineering du Cyber Apocalypse CTF 2024. Le programme attend un input spécifique qui, une fois entré correctement, révèle le flag.</p>
<h2 id="analyse-du-binaire">Analyse du binaire</h2>
<p>En analysant le binaire avec un désassembleur, nous avons découvert que le programme contient une chaîne encodée en Base64. Cette chaîne est ensuite décodée et comparée à l&rsquo;entrée utilisateur, mais avec une particularité : la comparaison se fait avec la chaîne inversée.</p>
<p>Voici le pseudocode extrait de la décompilation :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> input[<span style="color:#ae81ff">50</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> encoded_secret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;emFyZmZ1bkdsZWFW&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> decoded_secret[<span style="color:#ae81ff">50</span>];
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Décodage de la chaîne Base64
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">base64_decode</span>(encoded_secret, decoded_secret);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Entrez le mot de passe pour desceller la rune : &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, input);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Vérification du mot de passe
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> valid <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> len <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(decoded_secret);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> len; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (input[i] <span style="color:#f92672">!=</span> decoded_secret[len <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]) {
</span></span><span style="display:flex;"><span>            valid <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (valid) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Rune descellée ! Le flag est : HTB{%s}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, input);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Mot de passe incorrect.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="exploitation">Exploitation</h2>
<p>Pour résoudre ce challenge, nous devons :</p>
<ol>
<li>Décoder la chaîne Base64 &ldquo;emFyZmZ1bkdsZWFW&rdquo;</li>
<li>Inverser la chaîne décodée</li>
<li>Utiliser ce résultat comme mot de passe</li>
</ol>
<p>Voici le script Python que nous avons utilisé pour résoudre le challenge :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># La chaîne secrète encodée en Base64</span>
</span></span><span style="display:flex;"><span>encoded_secret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;emFyZmZ1bkdsZWFW&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Décodage Base64</span>
</span></span><span style="display:flex;"><span>decoded_secret <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b64decode(encoded_secret)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Chaîne décodée: </span><span style="color:#e6db74">{</span>decoded_secret<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Inversion de la chaîne</span>
</span></span><span style="display:flex;"><span>reversed_secret <span style="color:#f92672">=</span> decoded_secret[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Chaîne inversée (solution): </span><span style="color:#e6db74">{</span>reversed_secret<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h2 id="résolution">Résolution</h2>
<p>En exécutant notre script, nous obtenons :</p>
<pre tabindex="0"><code>$ python3 exploit.py
Chaîne décodée: zarffunGleaV
Chaîne inversée (solution): VaelGnuffrraz
</code></pre><p>Ainsi, le mot de passe correct est <code>VaelGnuffrraz</code>. En fournissant ce mot de passe au programme, nous obtenons le flag.</p>
<h2 id="étapes-de-lexploitation-manuelle">Étapes de l&rsquo;exploitation manuelle</h2>
<p>Si vous préférez résoudre ce challenge manuellement sans utiliser de script, voici les étapes :</p>
<ol>
<li>Identifiez la chaîne encodée &ldquo;emFyZmZ1bkdsZWFW&rdquo; dans le binaire</li>
<li>Décodez-la en Base64 (vous pouvez utiliser des outils en ligne ou la commande suivante) :
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;emFyZmZ1bkdsZWFW&#34;</span> | base64 -d
</span></span></code></pre></div>Résultat : zarffunGleaV</li>
<li>Inversez cette chaîne (vous pouvez le faire manuellement ou avec la commande suivante) :
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;zarffunGleaV&#34;</span> | rev
</span></span></code></pre></div>Résultat : VaelGnuffrraz</li>
<li>Utilisez &ldquo;VaelGnuffrraz&rdquo; comme input pour le programme</li>
</ol>
<h2 id="flag">Flag</h2>
<p>En entrant le mot de passe correct, le programme nous révèle le flag :</p>
<pre tabindex="0"><code>$ ./challenge
Entrez le mot de passe pour desceller la rune : VaelGnuffrraz
Rune descellée ! Le flag est : HTB{run3_m4g1c_r3v34l3d}
</code></pre><p>Le flag de ce challenge est donc : <code>HTB{run3_m4g1c_r3v34l3d}</code></p>
<h2 id="conclusion">Conclusion</h2>
<p>SealedRune est un challenge relativement simple qui illustre des techniques courantes utilisées pour obfusquer des chaînes de caractères dans les binaires :</p>
<ol>
<li>Encodage en Base64 pour masquer le contenu</li>
<li>Inversion de chaîne pour compliquer davantage l&rsquo;analyse</li>
</ol>
<p>Ce type de protection est souvent utilisé dans les crackmes basiques et constitue une bonne introduction aux techniques de reverse engineering. Pour résoudre ce challenge, il était nécessaire de :</p>
<ol>
<li>Identifier la chaîne encodée dans le binaire</li>
<li>Comprendre l&rsquo;algorithme de vérification du mot de passe</li>
<li>Effectuer les transformations inverses pour obtenir le mot de passe valide</li>
</ol>
<p>Bien que ces techniques d&rsquo;obfuscation soient rudimentaires, elles servent de base pour comprendre des mécanismes plus complexes de protection de binaires.</p>

    </div>
    
    <div class="page-footer">
        
        
        <div class="related-posts">
            <h3><i class="fas fa-link"></i> Articles connexes</h3>
            <div class="related-grid">
                
                <a href="/cybersecurity-notes/writeups/cyber-apocalypse/2024-04-14-boxofcourios/" class="related-item">
                    <h4>Cyber Apocalypse 2024 - BoxOfCourios</h4>
                    <div class="related-meta">
                        <span class="related-date">14/04/2024</span>
                        
                        <span class="related-tags">
                            
                            <span class="tag">binary-analysis</span>
                            
                        </span>
                        
                    </div>
                </a>
                
                <a href="/cybersecurity-notes/writeups/cyber-apocalypse/2024-04-14-endlesscycle/" class="related-item">
                    <h4>Cyber Apocalypse 2024 - EndlessCycle</h4>
                    <div class="related-meta">
                        <span class="related-date">14/04/2024</span>
                        
                        <span class="related-tags">
                            
                            <span class="tag">binary-analysis</span>
                            
                        </span>
                        
                    </div>
                </a>
                
            </div>
        </div>
        
        
        <div class="share">
            <span>Partager :</span>
            <a href="https://twitter.com/intent/tweet?url=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2fcyber-apocalypse%2f2024-04-14-sealedrune%2f&text=Cyber%20Apocalypse%202024%20-%20SealedRune" target="_blank" aria-label="Twitter">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2fcyber-apocalypse%2f2024-04-14-sealedrune%2f" target="_blank" aria-label="LinkedIn">
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="mailto:?subject=Cyber%20Apocalypse%202024%20-%20SealedRune&body=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2fcyber-apocalypse%2f2024-04-14-sealedrune%2f" aria-label="Email">
                <i class="fas fa-envelope"></i>
            </a>
        </div>
    </div>
</article>

</main>
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-left">
                <p>&copy; 2025 WriteUps &amp; Recherches Cybersécurité</p>
            </div>
            <div class="footer-right">
                <div class="social-links">
                    <a href="https://github.com/Istaarkk" target="_blank" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="#" target="_blank" aria-label="Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" target="_blank" aria-label="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Site propulsé par <a href="https://gohugo.io/" target="_blank">Hugo</a> | Thème <span class="theme-name">CyberNotes</span></p>
        </div>
    </footer>

    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        hljs.highlightAll();
        
        
        document.querySelectorAll('pre code').forEach((block) => {
            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copier';
            
            const pre = block.parentNode;
            pre.style.position = 'relative';
            pre.insertBefore(button, pre.firstChild);
            
            button.addEventListener('click', () => {
                navigator.clipboard.writeText(block.textContent);
                button.textContent = 'Copié !';
                setTimeout(() => {
                    button.textContent = 'Copier';
                }, 2000);
            });
        });
        
        
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    });
    </script>
    
    
</body>
</html>  